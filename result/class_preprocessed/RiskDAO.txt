packag ncsu csc itrust dao mysql import java sql connect import java sql prepar statement import java sql import java util list import ncsu csc itrust util import ncsu csc itrust bean famili member bean import ncsu csc itrust dao factori import ncsu csc itrust find risk factor patient stand databas access object intend reflect databas tabl databas time complex set queri extra ad assum data valid correct setter ani paramet constructor factori access factori link factori everi factori obtain connect access author andi public class risk privat factori factori typic constructor param factori link factori associ obtain connect public risk factori factori factori factori method implement link famili reason definit famili member chang central code code littl bit nicer execut queri famili member method slow refactor otherwis simpl param patient patient question param icd doubl bound code param icd upper doubl upper bound code return boolean indic famili member match rang throw public boolean famili histori long patient doubl icd doubl icd upper throw list famili member bean famili member famili member patient famili member bean fam member famili member prior diagnos fam member mid icd icd upper return true return fals privat list famili member bean famili member long patient throw famili fam factori famili list famili member bean famili member fam parent patient famili member add fam sibl patient return famili member return patient childhood infect exact code param patient patient question param icd code paramet list code match return boolean indic patient list code throw public boolean childhood infect long patient doubl icd code throw note datediff call function differ date return valu term day day year count leap year connect conn null prepar statement null tri conn factori connect conn prepar statement diagnosi ovd offic visit patient ovd visit patientid mid mid datediff visitd dateofbirth ovd icdcod creat prepar icd code length set long patient set icd code return execut queri queri row catch print stack trace throw final util close connect conn privat string creat prepar int length string str int length str return str substr str length privat void set int start prepar statement doubl icd code throw doubl icd code icd code set doubl start icd code return patient smoke life param patient patient question return boolean indic patient smoke throw public boolean smoke long patient throw connect conn null prepar statement null tri conn factori connect conn prepar statement person health inform patient smoker set long patient return execut queri queri row catch print stack trace throw final util close connect conn return patient diagnos code rang upper param patient patient question param code doubl code param upper code doubl upper code return boolean indic match rang throw public boolean prior diagnos long patient doubl code doubl upper code throw connect conn null prepar statement null tri conn factori connect conn prepar statement diagnosi ovd offic visit patient ovd visit patientid mid mid ovd icdcod ovd icdcod set long patient set doubl code set doubl upper code return execut queri queri row catch print stack trace throw final util close connect conn 