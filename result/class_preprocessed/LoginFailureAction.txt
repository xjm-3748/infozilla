packag ncsu csc itrust action import java sql import ncsu csc itrust dao factori import ncsu csc itrust dao mysql auth import ncsu csc itrust pleas note mitig denial servic attack track password failur attempt user account easili spoofabl address reason featur implement address limit tomcat authent actual technic fault specifi form account lockout authent applic tomcat doesn support account lockout option implement authent yuck extend realm class tomcat sourc code add logic actual pretti easi reason implement code buri jar tomcat instal veri educ learn authent webapp feel free chang extend perfect accept author andi public class login failur action public static final int privat auth auth privat string addr privat boolean valid captcha privat boolean attempt set default param factori factori creat action param addr address user login attempt public login failur action factori factori string addr auth factori auth addr addr valid captcha fals attempt fals call auth record login failur databas return mani login failur attempt messag public string record login failur tri auth record login failur addr int login failur auth login failur addr attempt true return login fail attempt login failur catch print stack trace return messag check current user login failur return true user valid login public boolean valid login tri return auth login failur addr valid captcha catch return fals public boolean captcha tri return auth login failur addr catch system err println deni access due return fals public void reset failur throw attempt auth reset login failur addr attempt fals public void set captcha boolean val valid captcha val public int failur count tri return auth login failur addr catch return 