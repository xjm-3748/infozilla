packag ncsu csc itrust dao mysql import java sql connect import java sql prepar statement import java sql result set import java sql import java util list import ncsu csc itrust util import ncsu csc itrust bean famili member bean import ncsu csc itrust bean loader famili bean loader import ncsu csc itrust dao factori import ncsu csc itrust queri relat famili stand databas access object intend reflect databas tabl databas time complex set queri extra ad assum data valid correct setter ani paramet constructor factori access factori link factori everi factori obtain connect access author andi public class famili privat factori factori privat famili bean loader famili bean loader typic constructor param factori link factori associ obtain connect public famili factori factori factori factori return inform mother father patient param pid patient return throw public list famili member bean parent long pid throw return famili member pid parent patient patient mother father fals return list patient share parent parent patient param pid patient return java util list famili member bean throw public list famili member bean sibl long pid throw return famili member pid sibl patient patient mother mother mother father father father fals return list patient mother father patient param pid patient return java util list famili member bean throw public list famili member bean children long pid throw return famili member pid child patient mother father true privat helper method sinc alik param pid param relat param queri param param add pid paramet queri littl differ return java util list famili member bean throw privat list famili member bean famili member long pid string relat string queri boolean param throw connect conn null prepar statement null famili bean loader famili bean loader relat tri conn factori connect conn prepar statement queri set long pid param set long pid result set execut queri return famili bean loader load list catch print stack trace throw final util close connect conn 