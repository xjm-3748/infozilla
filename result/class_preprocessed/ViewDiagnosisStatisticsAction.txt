packag ncsu csc itrust action import java text pars import java text simpl date format import java util array list import java util calendar import java util date import java util list import ncsu csc itrust bean diagnosi bean import ncsu csc itrust bean diagnosi statist bean import ncsu csc itrust dao factori import ncsu csc itrust dao mysql diagnos import ncsu csc itrust dao mysql code import ncsu csc itrust import ncsu csc itrust form valid import ncsu csc itrust trust view diagnosi statist page return list diagnos diagnosi statist specifi zip code diagnosi code date rang author student public class view diagnosi statist action databas access method code diagnos privat code icd databas access method diagnosi inform privat diagnos diagnos code malaria privat static final string code influenza privat static final string constructor action initi field param factori session factori public view diagnosi statist action factori factori icd factori code diagnos factori diagnos diagnosi code trust return list bean return list diagnosi bean correl code throw throw trust public list diagnosi bean diagnosi code throw trust return icd code count local region diagnos specifi input param date date time rang param upper date date time rang param icd code diagnosi code examin param zip zip code examin return bean local region count throw form valid throw throw trust public diagnosi statist bean diagnosi statist string date string upper date string icd code string zip throw form valid trust diagnosi statist bean bean tri date null upper date null icd code null return null date simpl date format yyyi pars date date upper simpl date format yyyi pars upper date upper throw form valid start date befor date zip match throw form valid zip code digit boolean valid code fals diagnosi bean diag diagnosi code diag code equal icd code valid code true valid code fals throw form valid code valid diagnosi bean diagnos diagnosi count icd code zip upper catch pars throw form valid enter date yyyi return bean local region count specifi week calcul prior averag param start date date week analyz param icd code diagnosi analyz param zip area analyz return statist week previous averag throw form valid throw public array list diagnosi statist bean epidem statist string start date string icd code string zip throw form valid start date null icd code null return null icd code equal icd code equal throw form valid date pars start date tri simpl date format yyyi pars start date catch pars auto generat catch block throw form valid enter date yyyi zip match throw form valid zip code digit diagnosi statist bean week diagnos count week icd code zip diagnosi statist bean avg diagnosi statist bean zip calendar cal calendar instanc date start diagnos find earliest incid icd code start set earliest incid calendar start cal calendar instanc start cal set time start array list diagnosi statist bean ret array list diagnosi statist bean start null ret add week ret add avg return ret cal set time cal set calendar cal calendar instanc cal set time int week cal calendar cal set calendar start cal calendar cal year set start year array list diagnosi statist bean list array list diagnosi statist bean cal time befor cal calendar cal calendar list add diagnos count week icd code zip cal time cal add calendar cal set calendar week cal set calendar calendar long avg long avg region list size diagnosi statist bean list avg zip stat avg region region stat avg list size avg region list size avg set region stat avg region avg set zip stat avg ret add week ret add avg return ret determin influenza epidem happen param cur date str date current evalu week param zip zip code analyz return epidem throw pars throw public boolean flu epidem string cur date str string zip throw pars simpl date format yyyi pars date cur date simpl date format yyyi pars cur date str calendar cal calendar instanc cal set time cur date int week cal calendar doubl threshold calc threshold week doubl threshold calc threshold week doubl threshold calc threshold week diagnosi statist bean diagnos count week zip cal time cal add calendar diagnosi statist bean diagnos count week zip cal time cal add calendar diagnosi statist bean diagnos count week zip cal time doubl week doubl region stat doubl week doubl region stat doubl week doubl region stat week threshold week threshold week threshold return true els return fals calcul threshold influenza epidem param week number week year return epidem threshold flu case privat doubl calc threshold doubl week number return week number math sin math week number math cos math week number determin malaria epidem happen param week date date current evalu week param zip zip code analyz param threshold str threshold epidem return epidem throw throw pars public boolean malaria epidem string week date string zip string threshold str throw pars date date simpl date format yyyi pars week date array list diagnosi statist bean list array list diagnosi statist bean array list diagnosi statist bean list array list diagnosi statist bean array list diagnosi statist bean list array list diagnosi statist bean int threshold integ pars int threshold str diagnosi statist bean current diagnos count week zip date long week total current region stat calendar cal calendar instanc cal set time date cal add calendar diagnosi statist bean diagnos count week zip cal time long week total region stat cal add calendar diagnosi statist bean diagnos count week zip cal time long week total region stat cal set time date int week cal calendar find earliest malaria case set calendar year year date start data diagnos find earliest incid start data null current region stat return true return fals calendar start date cal calendar instanc start date cal set time start data calendar date cal calendar instanc date cal set time date cal set calendar start date cal calendar cal time befor date cal calendar date cal calendar list add diagnos count week zip cal time cal add calendar list add diagnos count week zip cal time cal add calendar list add diagnos count week zip cal time cal add calendar cal set calendar week cal set calendar calendar long total diagnosi statist bean list total region stat diagnosi statist bean list region stat diagnosi statist bean list region stat long avg long avg long avg list size avg total list size avg total list size avg total list size week total week total threshold avg week total week total threshold avg week total week total threshold avg return true els return fals 