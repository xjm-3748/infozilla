packag ncsu csc itrust dao mysql import java sql connect import java sql prepar statement import java sql import java util list import ncsu csc itrust util import ncsu csc itrust bean survey result bean import ncsu csc itrust bean loader survey result bean loader import ncsu csc itrust dao factori import ncsu csc itrust handl survey result stand databas access object intend reflect databas tabl databas time complex set queri extra ad assum data valid correct setter ani paramet constructor factori access factori link factori everi factori obtain connect access public class survey result privat factori factori privat survey result bean loader loader typic constructor param factori link factori associ obtain connect public survey result factori factori factori factori loader survey result bean loader return survey result databas correspond zip code param zip zipcod interest string param specialti specialti interest string return java util list survey result bean throw public list survey result bean survey result zip string zip string specialti throw connect conn null prepar statement null string buffer sql string buffer sql append select mid firstnam lastnam address address citi state zip specialti sql append hospit sql append avg wait room minut avg wait room minut sql append avg exam room minut avg exam room minut sql append avg visit satisfact avg visit satisfact sql append avg treatment satisfact avg treatment satisf sql append count sql append select count personnel officevisit sql append hcpid mid sql append substr zip sql append mid mid percent satisfact result sql append ovsurvey personnel officevisit sql append visitid sql append hcpid mid sql append substr zip specialti equal survey result bean sql append specialti sql append group mid firstnam lastnam address address citi state zip hospit specialti equal survey result bean sql append specialti sql append order mid tri conn factori connect conn prepar statement sql string set string zip substr set string zip substr specialti equal survey result bean set string specialti return loader load list execut queri catch print stack trace throw final util close connect conn return survey data associ hospit specialti param hospit uniqu trust hospit queri param specialti string repres specialti interest return java util list survey result bean throw public list survey result bean survey result hospit string hospit string specialti throw connect conn null prepar statement null string buffer sql string buffer sql append select mid firstnam lastnam address address citi state zip specialti sql append hosid hospit sql append avg wait room minut avg wait room minut sql append avg exam room minut avg exam room minut sql append avg visit satisfact avg visit satisfact sql append avg treatment satisfact avg treatment satisf sql append count sql append select count personnel officevisit assign hos sql append hcpid mid sql append hcpid hcpid sql append hosid sql append mid mid percent satisfact result sql append ovsurvey personnel officevisit assign hos sql append visitid sql append hcpid mid sql append hcpid hcpid sql append hosid specialti equal survey result bean sql append specialti sql append group mid firstnam lastnam address address citi state zip hospit specialti equal survey result bean sql append specialti sql append order mid tri conn factori connect conn prepar statement sql string set string hospit set string hospit specialti equal survey result bean set string specialti return loader load list execut queri catch print stack trace throw final util close connect conn 