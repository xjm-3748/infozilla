packag ncsu csc itrust dao mysql import java sql connect import java sql prepar statement import java sql result set import java sql import java util hash map import java util list import ncsu csc itrust util import ncsu csc itrust bean referr bean import ncsu csc itrust bean verbos referr bean import ncsu csc itrust bean loader referr bean loader import ncsu csc itrust bean loader verbos referr bean loader import ncsu csc itrust dao factori import ncsu csc itrust enum sort direct import ncsu csc itrust updat referr fetch list referr stand databas access object intend reflect databas tabl databas time complex set queri extra ad assum data valid correct setter ani paramet constructor factori access factori link factori everi factori obtain connect access public class referr privat factori factori privat referr bean loader referr loader privat verbos referr bean loader verbos loader typic constructor param factori link factori associ obtain connect public referr factori factori factori factori referr loader referr bean loader verbos loader verbos referr bean loader referr associ offic visit param ovid offic visit return list referr bean throw public list referr bean referr long ovid throw connect conn null prepar statement null tri conn factori connect conn prepar statement referr set long ovid result set execut queri return referr loader load list catch print stack trace throw final util close connect conn list referr param mid mid return list referr throw public list referr bean referr long mid throw connect conn null prepar statement null tri conn factori connect conn prepar statement referr sender set long mid result set execut queri return referr loader load list catch print stack trace throw final util close connect conn specif referr param referr retriev return referr bean throw public referr bean referr long throw connect conn null prepar statement null tri conn factori connect conn prepar statement referr set long result set execut queri return referr loader load singl els return null catch print stack trace throw final util close connect conn set referr messag param referr retriev return referr bean throw public boolean set referr messag long messag long referr throw connect conn null prepar statement null tri conn factori connect conn prepar statement referr messag messag referr set long messag set long referr execut updat catch print stack trace throw final util close connect conn return true set referr messag param referr retriev return referr bean throw public long referr messag long messag throw connect conn null prepar statement null tri conn factori connect conn prepar statement referr messag messag set long messag result set execut queri return long els return catch print stack trace throw final util close connect conn list referr param mid mid return list referr throw public list referr bean referr long mid throw connect conn null prepar statement null tri conn factori connect conn prepar statement referr receiv set long mid result set execut queri return referr loader load list catch print stack trace throw final util close connect conn list referr receiv param mid patient mid return list referr receiv throw public list referr bean referr receiv long mid throw connect conn null prepar statement null tri conn factori connect conn prepar statement referr receiv prioriti code set long mid result set execut queri return referr loader load list catch print stack trace throw final util close connect conn list referr patient param mid patient mid return list referr receiv throw public list referr bean referr patient long mid throw connect conn null prepar statement null tri conn factori connect conn prepar statement referr patient view patient prioriti code set long mid result set execut queri return referr loader load list catch print stack trace throw final util close connect conn list referr patient param mid patient mid return list referr receiv unread throw public list referr bean referr receiv unread long mid throw connect conn null prepar statement null tri conn factori connect conn prepar statement referr receiv view fals set long mid result set execut queri return referr loader load list catch print stack trace throw final util close connect conn list referr patient param mid patient mid return list referr receiv unread throw public list referr bean referr patient unread long mid throw connect conn null prepar statement null tri conn factori connect conn prepar statement referr patient view patient fals set long mid result set execut queri return referr loader load list catch print stack trace throw final util close connect conn updat referr databas param referr updat throw public void edit referr referr bean throw connect conn null prepar statement null tri conn factori connect conn prepar statement referr patient sender receiv referr detail view patient view prioriti code referr loader load paramet set long execut updat catch print stack trace throw final util close connect conn add referr databas param referr add throw public long add referr referr bean throw connect conn null prepar statement null tri conn factori connect conn prepar statement referr patient sender receiv referr detail view patient view prioriti code time stamp referr loader load paramet execut updat return util insert conn catch print stack trace throw final util close connect conn remov referr param uniqu referr remov throw public void remov referr long throw connect conn null prepar statement null tri conn factori connect conn prepar statement referr set long execut updat catch print stack trace throw final util close connect conn abstract class encapsul sort queri referr deriv class provid user retriev referr public abstract class referr list queri privat factori factori privat long userid privat hash map string string sort column creat referr list queri object param factori param userid public referr list queri factori factori long userid factori factori userid userid initi lookup map sort column hash map string string sort column put patient patient patient sort column put receiv preceiv preceiv sort column put sender psender psender sort column put timestamp referr timestamp sort column put prioriti referr prioriti code perform queri param sort field pseudo field sort param dir direct desir sort ascend descend return list verbos referr bean throw protect list verbos referr bean doqueri string sort field sort direct dir throw string stmt psender psender sender preceiv preceiv receiv referr officevisit visit date patient patient patient referr personnel psender personnel preceiv patient officevisit referr sender psender mid referr receiv preceiv mid referr patient patient mid referr ovid officevisit stmt string format user field stmt build sort sort field dir connect conn null prepar statement null tri conn factori connect conn prepar statement stmt set long user result set execut queri return verbos loader load list catch print stack trace throw final util close connect conn perform queri param sort field pseudo field sort param dir direct desir sort ascend descend return list verbos referr bean throw public list verbos referr bean queri string sort field sort direct dir throw list verbos referr bean bean doqueri sort field dir return bean user pseudo field limit queri onli referr field equal specif user return overridden deriv class return user field string protect abstract string user field protect long user return userid build sort portion queri portion param sort field pseudo field sort param dir sort direct return string part queri protect string build sort string sort field sort direct dir string sortexp sort column sort field return string format sortexp dir concret referr list queri access referr public class sender referr list queri extend referr list queri public sender referr list queri factori factori long userid super factori userid overrid protect string user field return referr sender concret referr list queri access receiv referr public class receiv referr list queri extend referr list queri public receiv referr list queri factori factori long userid super factori userid overrid protect string user field return referr receiv concret referr list queri access patient referr public class patient referr list queri extend referr list queri public patient referr list queri factori factori long userid super factori userid overrid protect string user field return referr patient referr queri send param mid return referr list queri object public referr list queri sender queri long mid return sender referr list queri factori mid referr queri receiv param mid return referr list queri object public referr list queri receiv queri long mid return receiv referr list queri factori mid referr queri patient param mid patient return referr list queri object public referr list queri patient queri long pid return patient referr list queri factori pid 