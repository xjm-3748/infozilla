packag ncsu csc itrust action import java util array import ncsu csc itrust email util import ncsu csc itrust bean email import ncsu csc itrust bean patient bean import ncsu csc itrust bean personnel bean import ncsu csc itrust dao factori import ncsu csc itrust dao mysql auth import ncsu csc itrust dao mysql patient import ncsu csc itrust dao mysql personnel import ncsu csc itrust enum role import ncsu csc itrust import ncsu csc itrust error list import ncsu csc itrust form valid import ncsu csc itrust trust import ncsu csc itrust valid valid format manag reset password reset password jsp author laurenhayward public class reset password action public static final int privat auth auth privat patient patient privat factori factori set default param factori factori creat action public reset password action factori factori auth factori auth patient factori patient factori factori check user exist mid param mid string user check return user doe exist els mid user long public long check string mid string tri long mid long valu mid string auth check user exist mid return return mid catch number format return catch return check number reset password attempt exceed address param address address string return true number reset attempt greater equal throw public boolean max string address throw return auth reset password failur address check mid match role param mid mid check param role role check return true mid role match throw trust public string check role long mid string role throw trust tri patient equal role patient role mid role equal patient hcp equal role patient role mid role equal hcp uap equal role patient role mid role equal uap pha equal role patient role mid role equal pha equal role patient role mid role equal equal role patient role mid role equal return role els return null catch print stack trace catch trust print stack trace throw return null check answer param null param answer user secur answer return answer null els return null public string check answer null string answer answer null equal answer return null els return answer return secur question mid param param mid user return secur question thrown throw trust public string secur question long mid throw trust tri null auth secur question mid auth secur question mid equal throw trust secur question answer user set els return auth secur question mid catch print stack trace return reset password mid param mid user password reset param role role user trust param answer answer secur question param password password param confirm password password param addr address request return status messag throw form valid throw throw trust public string reset password long mid string role string answer string password string confirm password string addr throw form valid trust role auth user role mid tri role pars role catch illeg argument return invalid role equal role return role chang equal role pars role return role mismatch auth reset password failur addr return mani retri tri valid password password confirm password answer equal auth secur answer mid auth reset password mid password email util factori send email email app mid role return password chang els auth record reset password failur addr return answer match catch return error valid secur answer creat send mail chang param mid user password chang param role role trust return mial throw privat email email app long mid string role throw role pars role role patient bean patient factori patient mid email email email email set repli itrust email set list array list email email set subject password chang trust email set bodi string format dear chosen chang trust password user full mid return email els admin reset password personnel bean personnel factori personnel mid email email email email set repli itrust email set list array list email email set subject password chang trust email set bodi string format dear chosen chang trust password user full mid return email check password correct enter param password password param confirm password password confirm throw form valid privat void valid password string password string confirm password throw form valid error list error list error list password null equal password error list add null password empti els password equal confirm password error list add null password don match valid format regex matcher password match error list add null password follow format valid format descript error list error throw form valid error list 